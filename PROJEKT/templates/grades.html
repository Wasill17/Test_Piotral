{% extends "base.html" %}

{% block head %}
  <title>Oceny Uczniów</title>
  <style>
    .grades-container {
      width: 80%;
      margin: 0 auto;
      margin-top: 30px;
    }
    details {
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 10px;
      margin-bottom: 15px;
      background-color: #f9f9f9;
    }
    summary {
      font-size: 1.2em;
      font-weight: bold;
      cursor: pointer;
      outline: none;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f5f5f5;
    }
    .no-grades {
      font-style: italic;
      color: #666;
      text-align: center;
    }
  </style>
{% endblock %}

{% block body %}
  <div class="grades-container">
    <h1 style="text-align: center; font-size: 2em; margin-bottom: 20px;">Oceny Uczniów</h1>

    {% for group in groups %}
      <details>
        <summary>{{ group.name }}</summary>
        <table>
          <thead>
            <tr>
              <th>ID ucznia</th>
              <th>Imię i nazwisko</th>
              <th>Przedmiot</th>
              <th>Ocena</th>
              <th>Data dodania</th>
            </tr>
          </thead>
          <tbody>
            {% for student in group.students %}
              {% set count = student.grades|length %}
              <tr>
                <td>{{ student.id }}</td>
                <td>{{ student.first_name }} {{ student.last_name }}</td>
                {% if count > 0 %}
                  {% for grade in student.grades %}
                  <td>{{ grade.subject.subject_name }}</td>
                  <td>{{ grade.value }}</td>
                  <td>{{ grade.added_date.strftime("%Y-%m-%d") }}</td>
                </tr>
                  {% if not loop.last %}
                    <tr><td></td><td></td>
                  {% endif %}
                  {% endfor %}
                {% else %}
                  <td colspan="3" class="no-grades">Brak ocen</td>
                </tr>
                {% endif %}
            {% endfor %}
          </tbody>
        </table>
      </details>
    {% endfor %}
  </div>
{% endblock %}

